submodules: {}
lanes:
  main:
    # Assumes that N is pushed onto the stack before executing the program
    arguments:
      - N
    cards:
      - ty: ReadVar
        val: N

      - ty: Jump
        val: fib
      - ty: SetGlobalVar
        val: result

  fib:
    arguments:
      - N
    cards:
      - ty: ReadVar
        val: N
      - ty: ScalarInt
        val: 2
      - ty: ReadVar
        val: N
      - ty: LessOrEq
      - ty: IfElse
        val:
          then: fib_again
          else: fib_one
      - ty: Return

  fib_again:
    arguments:
      - N
    cards:
      - ty: ReadVar
        val: N
      - ty: ScalarInt
        val: 1
      - ty: Sub
      - ty: Jump
        val: fib
      - ty: ReadVar
        val: N
      - ty: ScalarInt
        val: 2
      - ty: Sub
      - ty: Jump
        val: fib
      - ty: Add
      - ty: Return

  fib_one:
    cards:
      - ty: ScalarInt
        val: 1
      - ty: Return
