submodules: {}
imports: []
lanes:
  main:
    arguments: []
    cards:
      # --- init the example table ---
      # {
      #  f1: 3,
      #  f2: 5,
      #  f3: 7,
      # }
      - !CreateTable
      - !SetVar t
      - !ReadVar t
      - !StringLiteral f1
      - !ScalarInt 3
      - !SetProperty
      - !ReadVar t
      - !StringLiteral f2
      - !ScalarInt 5
      - !SetProperty
      - !ReadVar t
      - !StringLiteral f3
      - !ScalarInt 7
      - !SetProperty # set result and g_iters to zero

      - !ScalarInt 0
      - !SetGlobalVar g_result
      - !ScalarInt 0
      - !SetGlobalVar g_iters
      # --- init done ---
      - !ForEach
        body: !Jump outer_loop
        variable: t

  outer_loop:
    arguments:
      - "key"
      - "table"
    cards:
      - !ForEach
        body: !Jump inner_loop
        variable: table

  inner_loop:
    arguments:
      - "key"
      - "table"
    cards:
      # get table[key]
      - !ReadVar table
      - !ReadVar key
      - !GetProperty # add table[key] to g_result

      - !ReadVar g_result
      - !Add
      - !SetGlobalVar g_result
        # add 1 to g_iters
      - !ScalarInt 1
      - !ReadVar g_iters
      - !Add
      - !SetGlobalVar g_iters
